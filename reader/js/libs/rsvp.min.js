!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(exports):"function"==typeof define&&define.amd?define(["exports"],e):e(t.RSVP={})}(this,function(t){"use strict";function i(t){return t._promiseCallbacks||(t._promiseCallbacks={})}var e={mixin:function(t){return t.on=this.on,t.off=this.off,t.trigger=this.trigger,t._promiseCallbacks=void 0,t},on:function(t,e){if("function"!=typeof e)throw new TypeError("Callback must be a function");var r=i(this),n=r[t];-1===(n=n||(r[t]=[])).indexOf(e)&&n.push(e)},off:function(t,e){var r,n=i(this);e?-1!==(e=(r=n[t]).indexOf(e))&&r.splice(e,1):n[t]=[]},trigger:function(t,e,r){var n=i(this)[t];if(n)for(var o=0;o<n.length;o++)(0,n[o])(e,r)}},c={instrument:!1};function r(t,e){if(2!==arguments.length)return c[t];c[t]=e}e.mixin(c);var n=[];function a(t,e,r){1===n.push({name:t,payload:{key:e._guidKey,id:e._id,eventName:t,detail:e._result,childId:r&&r._id,label:e._label,timeStamp:Date.now(),error:c["instrument-with-stack"]?new Error(e._label):null}})&&setTimeout(function(){for(var t=0;t<n.length;t++){var e=n[t],r=e.payload;r.guid=r.key+r.id,r.childGuid=r.key+r.childId,r.error&&(r.stack=r.error.stack),c.trigger(e.name,e.payload)}n.length=0},50)}function l(t,e){if(t&&"object"==typeof t&&t.constructor===this)return t;e=new this(y,e);return m(e,t),e}function y(){}var f=void 0,h=1,p=2,_={error:null};function d(t){try{return t.then}catch(t){return _.error=t,_}}var o=void 0;function s(){try{var t=o;return o=null,t.apply(this,arguments)}catch(t){return _.error=t,_}}function v(t){return o=t,s}function u(t,e,r){var n,o,i,s,u;e.constructor===t.constructor&&r===A&&t.constructor.resolve===l?(s=t,(u=e)._state===h?b(s,u._result):u._state===p?(u._onError=null,g(s,u._result)):j(u,void 0,function(t){(u===t?b:m)(s,t)},function(t){return g(s,t)})):r===_?(n=_.error,_.error=null,g(t,n)):"function"==typeof r?(n=t,o=e,i=r,c.async(function(e){var r=!1,t=v(i).call(o,function(t){r||(r=!0,(o===t?b:m)(e,t))},function(t){r||(r=!0,g(e,t))},"Settle: "+(e._label||" unknown promise"));r||t!==_||(r=!0,t=_.error,_.error=null,g(e,t))},n)):b(t,e)}function m(t,e){var r,n;t===e?b(t,e):(n=typeof(r=e),null===r||"object"!=n&&"function"!=n?b(t,e):u(t,e,d(e)))}function w(t){t._onError&&t._onError(t._result),O(t)}function b(t,e){t._state===f&&(t._result=e,t._state=h,0===t._subscribers.length?c.instrument&&a("fulfilled",t):c.async(O,t))}function g(t,e){t._state===f&&(t._state=p,t._result=e,c.async(w,t))}function j(t,e,r,n){var o=t._subscribers,i=o.length;t._onError=null,o[i]=e,o[i+h]=r,o[i+p]=n,0===i&&t._state&&c.async(O,t)}function O(t){var e=t._subscribers,r=t._state;if(c.instrument&&a(r===h?"fulfilled":"rejected",t),0!==e.length){for(var n,o=void 0,i=t._result,s=0;s<e.length;s+=3)n=e[s],o=e[s+r],n?E(r,n,o,i):o(i);t._subscribers.length=0}}function E(t,e,r,n){var o="function"==typeof r,i=void 0,i=o?v(r)(n):n;e._state!==f||(i===e?g(e,new TypeError("A promises callback cannot return that same promise.")):i===_?(n=_.error,_.error=null,g(e,n)):o?m(e,i):t===h?b(e,i):t===p&&g(e,i))}function A(t,e,r){var n=this,o=n._state;if(o===h&&!t||o===p&&!e)return c.instrument&&a("chained",n,n),n;n._onError=null;var i,s=new n.constructor(y,r),u=n._result;return c.instrument&&a("chained",n,s),o===f?j(n,s,t,e):(i=o===h?t:e,c.async(function(){return E(o,s,i,u)})),s}var T=(P.prototype._init=function(t,e){var r=e.length||0;this.length=r,this._remaining=r,this._result=new Array(r),this._enumerate(e)},P.prototype._enumerate=function(t){for(var e=this.length,r=this.promise,n=0;r._state===f&&n<e;n++)this._eachEntry(t[n],n,!0);this._checkFullfillment()},P.prototype._checkFullfillment=function(){var t;0===this._remaining&&(t=this._result,b(this.promise,t),this._result=null)},P.prototype._settleMaybeThenable=function(e,t,r){var n,o,i=this._instanceConstructor;this._isUsingOwnResolve?(n=d(e))===A&&e._state!==f?(e._onError=null,this._settledAt(e._state,t,e._result,r)):"function"!=typeof n?this._settledAt(h,t,e,r):this._isUsingOwnPromise?(u(o=new i(y),e,n),this._willSettleAt(o,t,r)):this._willSettleAt(new i(function(t){return t(e)}),t,r):this._willSettleAt(i.resolve(e),t,r)},P.prototype._eachEntry=function(t,e,r){null!==t&&"object"==typeof t?this._settleMaybeThenable(t,e,r):this._setResultAt(h,e,t,r)},P.prototype._settledAt=function(t,e,r,n){var o=this.promise;o._state===f&&(this._abortOnReject&&t===p?g(o,r):(this._setResultAt(t,e,r,n),this._checkFullfillment()))},P.prototype._setResultAt=function(t,e,r,n){this._remaining--,this._result[e]=r},P.prototype._willSettleAt=function(t,e,r){var n=this;j(t,void 0,function(t){return n._settledAt(h,e,t,r)},function(t){return n._settledAt(p,e,t,r)})},P);function P(t,e,r,n){this._instanceConstructor=t,this.promise=new t(y,n),this._abortOnReject=r,this._isUsingOwnPromise=t===x,this._isUsingOwnResolve=t.resolve===l,this._init.apply(this,arguments)}function S(t,e,r){this._remaining--,this._result[e]=t===h?{state:"fulfilled",value:r}:{state:"rejected",reason:r}}var R="rsvp_"+Date.now()+"-",k=0;var x=(M.prototype._onError=function(t){var e=this;c.after(function(){e._onError&&c.trigger("error",t,e._label)})},M.prototype.catch=function(t,e){return this.then(void 0,t,e)},M.prototype.finally=function(e,t){var r=this.constructor;return"function"==typeof e?this.then(function(t){return r.resolve(e()).then(function(){return t})},function(t){return r.resolve(e()).then(function(){throw t})}):this.then(e,e)},M);function M(t,e){this._id=k++,this._label=e,this._state=void 0,this._result=void 0,this._subscribers=[],c.instrument&&a("created",this),y!==t&&("function"!=typeof t&&function(){throw new TypeError("You must pass a resolver function as the first argument to the promise constructor")}(),this instanceof M?function(e,t){var r=!1;try{t(function(t){r||(r=!0,m(e,t))},function(t){r||(r=!0,g(e,t))})}catch(t){g(e,t)}}(this,t):function(){throw new TypeError("Failed to construct 'Promise': Please use the 'new' operator, this object constructor cannot be called as a function.")}())}function C(h,p){function t(){for(var t=arguments.length,e=new Array(t+1),r=!1,n=0;n<t;++n){var o=arguments[n];if(!r){if((r=null!==(s=o)&&"object"==typeof s&&(s.constructor===x||d(s)))===_){var i=_.error;_.error=null;var s=new x(y);return g(s,i),s}r&&!0!==r&&(o=function(r,n){return{then:function(t,e){return r.call(n,t,e)}}}(r,o))}e[n]=o}var u,c,a,l,f=new x(y);return e[t]=function(t,e){t?g(f,t):void 0===p?m(f,e):!0===p?m(f,function(t){for(var e=t.length,r=new Array(e-1),n=1;n<e;n++)r[n-1]=t[n];return r}(arguments)):Array.isArray(p)?m(f,function(t,e){for(var r={},n=t.length,o=new Array(n),i=0;i<n;i++)o[i]=t[i];for(var s=0;s<e.length;s++)r[e[s]]=o[s+1];return r}(arguments,p)):m(f,e)},r?(u=f,c=e,a=h,l=this,x.all(c).then(function(t){return F(u,t,a,l)})):F(f,e,h,this)}return t.__proto__=h,t}function F(t,e,r,n){return v(r).apply(n,e)===_&&(e=_.error,_.error=null,g(t,e)),t}function I(t,e){return x.all(t,e)}x.cast=l,x.all=function(t,e){return Array.isArray(t)?new T(this,t,!0,e).promise:this.reject(new TypeError("Promise.all must be called with an array"),e)},x.race=function(t,e){var r=new this(y,e);if(!Array.isArray(t))return g(r,new TypeError("Promise.race must be called with an array")),r;for(var n=0;r._state===f&&n<t.length;n++)j(this.resolve(t[n]),void 0,function(t){return m(r,t)},function(t){return g(r,t)});return r},x.resolve=l,x.reject=function(t,e){return g(e=new this(y,e),t),e},x.prototype._guidKey=R,x.prototype.then=A;var N,U=(function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(D,N=T),D);function D(t,e,r){return function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,N.call(this,t,e,!1,r))}function K(t,e){return Array.isArray(t)?new U(x,t,e).promise:x.reject(new TypeError("Promise.allSettled must be called with an array"),e)}function q(t,e){return x.race(t,e)}U.prototype._setResultAt=S;var G,L=(function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(V,G=T),V.prototype._init=function(t,e){this._result={},this._enumerate(e)},V.prototype._enumerate=function(t){var e=Object.keys(t),r=e.length,n=this.promise;this._remaining=r;for(var o,i,s=0;n._state===f&&s<r;s++)i=t[o=e[s]],this._eachEntry(i,o,!0);this._checkFullfillment()},V);function V(t,e){var r=!(2<arguments.length&&void 0!==arguments[2])||arguments[2],n=arguments[3];return function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,G.call(this,t,e,r,n))}function W(t,e){return x.resolve(t,e).then(function(t){if(null===t||"object"!=typeof t)throw new TypeError("Promise.hash must be called with an object");return new L(x,t,e).promise})}var Y,$=(function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(z,Y=L),z);function z(t,e,r){return function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,Y.call(this,t,e,!1,r))}function B(t,e){return x.resolve(t,e).then(function(t){if(null===t||"object"!=typeof t)throw new TypeError("hashSettled must be called with an object");return new $(x,t,!1,e).promise})}function H(t){throw setTimeout(function(){throw t}),t}function J(t){var r={resolve:void 0,reject:void 0};return r.promise=new x(function(t,e){r.resolve=t,r.reject=e},t),r}$.prototype._setResultAt=S;var Q,X=(function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(Z,Q=T),Z.prototype._init=function(t,e,r,n,o){var i=e.length||0;this.length=i,this._remaining=i,this._result=new Array(i),this._mapFn=o,this._enumerate(e)},Z.prototype._setResultAt=function(t,e,r,n){n?(n=v(this._mapFn)(r,e))===_?this._settledAt(p,e,n.error,!1):this._eachEntry(n,e,!1):(this._remaining--,this._result[e]=r)},Z);function Z(t,e,r,n){return function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,Q.call(this,t,e,!0,n,r))}function tt(t,e,r){return"function"!=typeof e?x.reject(new TypeError("map expects a function as a second argument"),r):x.resolve(t,r).then(function(t){if(!Array.isArray(t))throw new TypeError("map must be called with an array");return new X(x,t,e,r).promise})}function et(t,e){return x.resolve(t,e)}function rt(t,e){return x.reject(t,e)}var nt,ot={},it=(function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(st,nt=X),st.prototype._checkFullfillment=function(){var t;0===this._remaining&&null!==this._result&&(t=this._result.filter(function(t){return t!==ot}),b(this.promise,t),this._result=null)},st.prototype._setResultAt=function(t,e,r,n){n?(this._result[e]=r,(n=v(this._mapFn)(r,e))===_?this._settledAt(p,e,n.error,!1):this._eachEntry(n,e,!1)):(this._remaining--,r||(this._result[e]=ot))},st);function st(){return function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,nt.apply(this,arguments))}function ut(t,e,r){return"function"!=typeof e?x.reject(new TypeError("filter expects function as a second argument"),r):x.resolve(t,r).then(function(t){if(!Array.isArray(t))throw new TypeError("filter must be called with an array");return new it(x,t,e,r).promise})}var ct=0,at=void 0;function lt(t,e){_t[ct]=t,_t[ct+1]=e,2===(ct+=2)&&Ot()}var ft="undefined"!=typeof window?window:void 0,ht=ft||{},pt=ht.MutationObserver||ht.WebKitMutationObserver,R="undefined"==typeof self&&"undefined"!=typeof process&&"[object process]"==={}.toString.call(process),ht="undefined"!=typeof Uint8ClampedArray&&"undefined"!=typeof importScripts&&"undefined"!=typeof MessageChannel;function yt(){return function(){return setTimeout(dt,1)}}var _t=new Array(1e3);function dt(){for(var t=0;t<ct;t+=2)(0,_t[t])(_t[t+1]),_t[t]=void 0,_t[t+1]=void 0;ct=0}var vt,mt,wt,bt,gt,jt,Ot=void 0,Ot=R?(gt=process.nextTick,jt=process.versions.node.match(/^(?:(\d+)\.)?(?:(\d+)\.)?(\*|\d+)$/),Array.isArray(jt)&&"0"===jt[1]&&"10"===jt[2]&&(gt=setImmediate),function(){return gt(dt)}):pt?(mt=0,wt=new pt(dt),bt=document.createTextNode(""),wt.observe(bt,{characterData:!0}),function(){return bt.data=mt=++mt%2}):ht?((vt=new MessageChannel).port1.onmessage=dt,function(){return vt.port2.postMessage(0)}):(void 0===ft&&"function"==typeof require?function(){try{var t=Function("return this")().require("vertx");return void 0!==(at=t.runOnLoop||t.runOnContext)?function(){at(dt)}:yt()}catch(t){return yt()}}:yt)();c.async=lt,c.after=function(t){return setTimeout(t,0)};R=et,ht=function(t,e){return c.async(t,e)};function Et(){c.on.apply(c,arguments)}function At(){c.off.apply(c,arguments)}if("undefined"!=typeof window&&"object"==typeof window.__PROMISE_INSTRUMENTATION__){var Tt,Pt=window.__PROMISE_INSTRUMENTATION__;for(Tt in r("instrument",!0),Pt)Pt.hasOwnProperty(Tt)&&Et(Tt,Pt[Tt])}ft={asap:lt,cast:R,Promise:x,EventTarget:e,all:I,allSettled:K,race:q,hash:W,hashSettled:B,rethrow:H,defer:J,denodeify:C,configure:r,on:Et,off:At,resolve:et,reject:rt,map:tt,async:ht,filter:ut};t.default=ft,t.asap=lt,t.cast=R,t.Promise=x,t.EventTarget=e,t.all=I,t.allSettled=K,t.race=q,t.hash=W,t.hashSettled=B,t.rethrow=H,t.defer=J,t.denodeify=C,t.configure=r,t.on=Et,t.off=At,t.resolve=et,t.reject=rt,t.map=tt,t.async=ht,t.filter=ut,Object.defineProperty(t,"__esModule",{value:!0})});