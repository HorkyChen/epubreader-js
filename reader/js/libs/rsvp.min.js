/*! For license information please see rsvp.min.js.LICENSE.txt */
!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(exports):"function"==typeof define&&define.amd?define(["exports"],e):e(t.RSVP={})}(this,(function(t){"use strict";function e(t){var e=t._promiseCallbacks;return e||(e=t._promiseCallbacks={}),e}var r={mixin:function(t){return t.on=this.on,t.off=this.off,t.trigger=this.trigger,t._promiseCallbacks=void 0,t},on:function(t,r){if("function"!=typeof r)throw new TypeError("Callback must be a function");var n=e(this),o=n[t];o||(o=n[t]=[]),-1===o.indexOf(r)&&o.push(r)},off:function(t,r){var n=e(this);if(r){var o=n[t],i=o.indexOf(r);-1!==i&&o.splice(i,1)}else n[t]=[]},trigger:function(t,r,n){var o=e(this)[t];if(o)for(var i=0;i<o.length;i++)(0,o[i])(r,n)}},n={instrument:!1};function o(t,e){if(2!==arguments.length)return n[t];n[t]=e}r.mixin(n);var i=[];function s(t,e,r){1===i.push({name:t,payload:{key:e._guidKey,id:e._id,eventName:t,detail:e._result,childId:r&&r._id,label:e._label,timeStamp:Date.now(),error:n["instrument-with-stack"]?new Error(e._label):null}})&&setTimeout((function(){for(var t=0;t<i.length;t++){var e=i[t],r=e.payload;r.guid=r.key+r.id,r.childGuid=r.key+r.childId,r.error&&(r.stack=r.error.stack),n.trigger(e.name,e.payload)}i.length=0}),50)}function u(t,e){if(t&&"object"==typeof t&&t.constructor===this)return t;var r=new this(c,e);return v(r,t),r}function c(){}var a=void 0,f={error:null};function l(t){try{return t.then}catch(t){return f.error=t,f}}var h=void 0;function p(){try{var t=h;return h=null,t.apply(this,arguments)}catch(t){return f.error=t,f}}function y(t){return h=t,p}function _(t,e,r){if(e.constructor===t.constructor&&r===O&&t.constructor.resolve===u)!function(t,e){1===e._state?m(t,e._result):2===e._state?(e._onError=null,w(t,e._result)):b(e,void 0,(function(r){e===r?m(t,r):v(t,r)}),(function(e){return w(t,e)}))}(t,e);else if(r===f){var o=f.error;f.error=null,w(t,o)}else"function"==typeof r?function(t,e,r){n.async((function(t){var n=!1,o=y(r).call(e,(function(r){n||(n=!0,e===r?m(t,r):v(t,r))}),(function(e){n||(n=!0,w(t,e))}),"Settle: "+(t._label||" unknown promise"));if(!n&&o===f){n=!0;var i=f.error;f.error=null,w(t,i)}}),t)}(t,e,r):m(t,e)}function v(t,e){var r,n;t===e?m(t,e):(n=typeof(r=e),null===r||"object"!==n&&"function"!==n?m(t,e):_(t,e,l(e)))}function d(t){t._onError&&t._onError(t._result),g(t)}function m(t,e){t._state===a&&(t._result=e,t._state=1,0===t._subscribers.length?n.instrument&&s("fulfilled",t):n.async(g,t))}function w(t,e){t._state===a&&(t._state=2,t._result=e,n.async(d,t))}function b(t,e,r,o){var i=t._subscribers,s=i.length;t._onError=null,i[s]=e,i[s+1]=r,i[s+2]=o,0===s&&t._state&&n.async(g,t)}function g(t){var e=t._subscribers,r=t._state;if(n.instrument&&s(1===r?"fulfilled":"rejected",t),0!==e.length){for(var o=void 0,i=void 0,u=t._result,c=0;c<e.length;c+=3)o=e[c],i=e[c+r],o?j(r,o,i,u):i(u);t._subscribers.length=0}}function j(t,e,r,n){var o,i="function"==typeof r;if(o=i?y(r)(n):n,e._state!==a);else if(o===e)w(e,new TypeError("A promises callback cannot return that same promise."));else if(o===f){var s=f.error;f.error=null,w(e,s)}else i?v(e,o):1===t?m(e,o):2===t&&w(e,o)}function O(t,e,r){var o=this,i=o._state;if(1===i&&!t||2===i&&!e)return n.instrument&&s("chained",o,o),o;o._onError=null;var u=new o.constructor(c,r),f=o._result;if(n.instrument&&s("chained",o,u),i===a)b(o,u,t,e);else{var l=1===i?t:e;n.async((function(){return j(i,u,l,f)}))}return u}var E=function(){function t(t,e,r,n){this._instanceConstructor=t,this.promise=new t(c,n),this._abortOnReject=r,this._isUsingOwnPromise=t===S,this._isUsingOwnResolve=t.resolve===u,this._init.apply(this,arguments)}return t.prototype._init=function(t,e){var r=e.length||0;this.length=r,this._remaining=r,this._result=new Array(r),this._enumerate(e)},t.prototype._enumerate=function(t){for(var e=this.length,r=this.promise,n=0;r._state===a&&n<e;n++)this._eachEntry(t[n],n,!0);this._checkFullfillment()},t.prototype._checkFullfillment=function(){if(0===this._remaining){var t=this._result;m(this.promise,t),this._result=null}},t.prototype._settleMaybeThenable=function(t,e,r){var n=this._instanceConstructor;if(this._isUsingOwnResolve){var o=l(t);if(o===O&&t._state!==a)t._onError=null,this._settledAt(t._state,e,t._result,r);else if("function"!=typeof o)this._settledAt(1,e,t,r);else if(this._isUsingOwnPromise){var i=new n(c);_(i,t,o),this._willSettleAt(i,e,r)}else this._willSettleAt(new n((function(e){return e(t)})),e,r)}else this._willSettleAt(n.resolve(t),e,r)},t.prototype._eachEntry=function(t,e,r){null!==t&&"object"==typeof t?this._settleMaybeThenable(t,e,r):this._setResultAt(1,e,t,r)},t.prototype._settledAt=function(t,e,r,n){var o=this.promise;o._state===a&&(this._abortOnReject&&2===t?w(o,r):(this._setResultAt(t,e,r,n),this._checkFullfillment()))},t.prototype._setResultAt=function(t,e,r,n){this._remaining--,this._result[e]=r},t.prototype._willSettleAt=function(t,e,r){var n=this;b(t,void 0,(function(t){return n._settledAt(1,e,t,r)}),(function(t){return n._settledAt(2,e,t,r)}))},t}();function A(t,e,r){this._remaining--,this._result[e]=1===t?{state:"fulfilled",value:r}:{state:"rejected",reason:r}}var T="rsvp_"+Date.now()+"-",P=0,S=function(){function t(e,r){this._id=P++,this._label=r,this._state=void 0,this._result=void 0,this._subscribers=[],n.instrument&&s("created",this),c!==e&&("function"!=typeof e&&function(){throw new TypeError("You must pass a resolver function as the first argument to the promise constructor")}(),this instanceof t?function(t,e){var r=!1;try{e((function(e){r||(r=!0,v(t,e))}),(function(e){r||(r=!0,w(t,e))}))}catch(e){w(t,e)}}(this,e):function(){throw new TypeError("Failed to construct 'Promise': Please use the 'new' operator, this object constructor cannot be called as a function.")}())}return t.prototype._onError=function(t){var e=this;n.after((function(){e._onError&&n.trigger("error",t,e._label)}))},t.prototype.catch=function(t,e){return this.then(void 0,t,e)},t.prototype.finally=function(t,e){var r=this,n=r.constructor;return"function"==typeof t?r.then((function(e){return n.resolve(t()).then((function(){return e}))}),(function(e){return n.resolve(t()).then((function(){throw e}))})):r.then(t,t)},t}();function R(t,e){for(var r={},n=t.length,o=new Array(n),i=0;i<n;i++)o[i]=t[i];for(var s=0;s<e.length;s++)r[e[s]]=o[s+1];return r}function k(t){for(var e=t.length,r=new Array(e-1),n=1;n<e;n++)r[n-1]=t[n];return r}function x(t,e){return{then:function(r,n){return t.call(e,r,n)}}}function M(t,e){var r=function(){for(var r=arguments.length,n=new Array(r+1),o=!1,i=0;i<r;++i){var s=arguments[i];if(!o){if((o=I(s))===f){var u=f.error;f.error=null;var a=new S(c);return w(a,u),a}o&&!0!==o&&(s=x(o,s))}n[i]=s}var l=new S(c);return n[r]=function(t,r){t?w(l,t):void 0===e?v(l,r):!0===e?v(l,k(arguments)):Array.isArray(e)?v(l,R(arguments,e)):v(l,r)},o?F(l,n,t,this):C(l,n,t,this)};return r.__proto__=t,r}function C(t,e,r,n){if(y(r).apply(n,e)===f){var o=f.error;f.error=null,w(t,o)}return t}function F(t,e,r,n){return S.all(e).then((function(e){return C(t,e,r,n)}))}function I(t){return null!==t&&"object"==typeof t&&(t.constructor===S||l(t))}function N(t,e){return S.all(t,e)}S.cast=u,S.all=function(t,e){return Array.isArray(t)?new E(this,t,!0,e).promise:this.reject(new TypeError("Promise.all must be called with an array"),e)},S.race=function(t,e){var r=new this(c,e);if(!Array.isArray(t))return w(r,new TypeError("Promise.race must be called with an array")),r;for(var n=0;r._state===a&&n<t.length;n++)b(this.resolve(t[n]),void 0,(function(t){return v(r,t)}),(function(t){return w(r,t)}));return r},S.resolve=u,S.reject=function(t,e){var r=new this(c,e);return w(r,t),r},S.prototype._guidKey=T,S.prototype.then=O;var U=function(t){function e(e,r,n){return function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,t.call(this,e,r,!1,n))}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,t),e}(E);function D(t,e){return Array.isArray(t)?new U(S,t,e).promise:S.reject(new TypeError("Promise.allSettled must be called with an array"),e)}function K(t,e){return S.race(t,e)}function q(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}U.prototype._setResultAt=A;var G=function(t){function e(e,r){var n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],o=arguments[3];return q(this,t.call(this,e,r,n,o))}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,t),e.prototype._init=function(t,e){this._result={},this._enumerate(e)},e.prototype._enumerate=function(t){var e=Object.keys(t),r=e.length,n=this.promise;this._remaining=r;for(var o=void 0,i=void 0,s=0;n._state===a&&s<r;s++)i=t[o=e[s]],this._eachEntry(i,o,!0);this._checkFullfillment()},e}(E);function L(t,e){return S.resolve(t,e).then((function(t){if(null===t||"object"!=typeof t)throw new TypeError("Promise.hash must be called with an object");return new G(S,t,e).promise}))}var V=function(t){function e(e,r,n){return function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,t.call(this,e,r,!1,n))}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,t),e}(G);function W(t,e){return S.resolve(t,e).then((function(t){if(null===t||"object"!=typeof t)throw new TypeError("hashSettled must be called with an object");return new V(S,t,!1,e).promise}))}function Y(t){throw setTimeout((function(){throw t})),t}function $(t){var e={resolve:void 0,reject:void 0};return e.promise=new S((function(t,r){e.resolve=t,e.reject=r}),t),e}V.prototype._setResultAt=A;var z=function(t){function e(e,r,n,o){return function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,t.call(this,e,r,!0,o,n))}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,t),e.prototype._init=function(t,e,r,n,o){var i=e.length||0;this.length=i,this._remaining=i,this._result=new Array(i),this._mapFn=o,this._enumerate(e)},e.prototype._setResultAt=function(t,e,r,n){if(n){var o=y(this._mapFn)(r,e);o===f?this._settledAt(2,e,o.error,!1):this._eachEntry(o,e,!1)}else this._remaining--,this._result[e]=r},e}(E);function B(t,e,r){return"function"!=typeof e?S.reject(new TypeError("map expects a function as a second argument"),r):S.resolve(t,r).then((function(t){if(!Array.isArray(t))throw new TypeError("map must be called with an array");return new z(S,t,e,r).promise}))}function H(t,e){return S.resolve(t,e)}function J(t,e){return S.reject(t,e)}function Q(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}var X={},Z=function(t){function e(){return Q(this,t.apply(this,arguments))}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,t),e.prototype._checkFullfillment=function(){if(0===this._remaining&&null!==this._result){var t=this._result.filter((function(t){return t!==X}));m(this.promise,t),this._result=null}},e.prototype._setResultAt=function(t,e,r,n){if(n){this._result[e]=r;var o=y(this._mapFn)(r,e);o===f?this._settledAt(2,e,o.error,!1):this._eachEntry(o,e,!1)}else this._remaining--,r||(this._result[e]=X)},e}(z);function tt(t,e,r){return"function"!=typeof e?S.reject(new TypeError("filter expects function as a second argument"),r):S.resolve(t,r).then((function(t){if(!Array.isArray(t))throw new TypeError("filter must be called with an array");return new Z(S,t,e,r).promise}))}var et=0,rt=void 0;function nt(t,e){ft[et]=t,ft[et+1]=e,2===(et+=2)&&mt()}var ot="undefined"!=typeof window?window:void 0,it=ot||{},st=it.MutationObserver||it.WebKitMutationObserver,ut="undefined"==typeof self&&"undefined"!=typeof process&&"[object process]"==={}.toString.call(process),ct="undefined"!=typeof Uint8ClampedArray&&"undefined"!=typeof importScripts&&"undefined"!=typeof MessageChannel;function at(){return function(){return setTimeout(lt,1)}}var ft=new Array(1e3);function lt(){for(var t=0;t<et;t+=2)(0,ft[t])(ft[t+1]),ft[t]=void 0,ft[t+1]=void 0;et=0}var ht,pt,yt,_t,vt,dt,mt=void 0;ut?(vt=process.nextTick,dt=process.versions.node.match(/^(?:(\d+)\.)?(?:(\d+)\.)?(\*|\d+)$/),Array.isArray(dt)&&"0"===dt[1]&&"10"===dt[2]&&(vt=setImmediate),mt=function(){return vt(lt)}):st?(pt=0,yt=new st(lt),_t=document.createTextNode(""),yt.observe(_t,{characterData:!0}),mt=function(){return _t.data=pt=++pt%2}):ct?((ht=new MessageChannel).port1.onmessage=lt,mt=function(){return ht.port2.postMessage(0)}):mt=void 0===ot&&"function"==typeof require?function(){try{var t=Function("return this")().require("vertx");return void 0!==(rt=t.runOnLoop||t.runOnContext)?function(){rt(lt)}:at()}catch(t){return at()}}():at(),n.async=nt,n.after=function(t){return setTimeout(t,0)};var wt=H,bt=function(t,e){return n.async(t,e)};function gt(){n.on.apply(n,arguments)}function jt(){n.off.apply(n,arguments)}if("undefined"!=typeof window&&"object"==typeof window.__PROMISE_INSTRUMENTATION__){var Ot=window.__PROMISE_INSTRUMENTATION__;for(var Et in o("instrument",!0),Ot)Ot.hasOwnProperty(Et)&&gt(Et,Ot[Et])}var At={asap:nt,cast:wt,Promise:S,EventTarget:r,all:N,allSettled:D,race:K,hash:L,hashSettled:W,rethrow:Y,defer:$,denodeify:M,configure:o,on:gt,off:jt,resolve:H,reject:J,map:B,async:bt,filter:tt};t.default=At,t.asap=nt,t.cast=wt,t.Promise=S,t.EventTarget=r,t.all=N,t.allSettled=D,t.race=K,t.hash=L,t.hashSettled=W,t.rethrow=Y,t.defer=$,t.denodeify=M,t.configure=o,t.on=gt,t.off=jt,t.resolve=H,t.reject=J,t.map=B,t.async=bt,t.filter=tt,Object.defineProperty(t,"__esModule",{value:!0})}));